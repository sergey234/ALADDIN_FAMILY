{
  "file": "security/ai_agents/threat_intelligence_agent.py",
  "timestamp": "2025-09-20T20:31:58.819791",
  "total_analysis_time_seconds": 0.12020707130432129,
  "overall_quality_score": 88.6,
  "analysis_details": {
    "flake8": {
      "status": "success",
      "errors": [],
      "message": "Найдено 0 ошибок flake8"
    },
    "sfm_functions": {
      "status": "info",
      "found_functions": [],
      "message": "Найдено 0 функций SFM"
    },
    "security_keywords": {
      "status": "success",
      "found_keywords": [
        "security",
        "hash",
        "key",
        "threat",
        "vulnerability",
        "malware",
        "response",
        "log",
        "analysis"
      ],
      "message": "Найдено 9 ключевых слов безопасности"
    },
    "syntax": {
      "status": "success",
      "message": "Синтаксис корректен"
    },
    "security_classes": {
      "status": "success",
      "found_classes": [
        "ThreatIntelligenceAgent"
      ],
      "message": "Найдено 1 классов системы безопасности"
    },
    "file_info": {
      "status": "info",
      "size_bytes": 55243,
      "lines": 1538,
      "message": "Размер: 55243 байт, Строк: 1538"
    },
    "docstrings": {
      "status": "warning",
      "missing_docstrings": [
        "Отсутствует docstring для decorator (строка 65)",
        "Отсутствует docstring для __init__ (строка 203)",
        "Отсутствует docstring для __init__ (строка 361)",
        "Отсутствует docstring для __init__ (строка 441)",
        "Отсутствует docstring для wrapper (строка 66)",
        "Отсутствует docstring для SecurityBase (строка 137)",
        "Отсутствует docstring для __init__ (строка 138)",
        "Отсутствует docstring для log_activity (строка 142)"
      ],
      "message": "Найдено 8 отсутствующих docstring"
    },
    "type_hints": {
      "status": "warning",
      "missing_type_hints": [
        "Отсутствует тип возвращаемого значения для функции measure_time (строка 62)",
        "Отсутствует тип возвращаемого значения для функции performance_monitor (строка 81)",
        "Отсутствует тип возвращаемого значения для функции decorator (строка 65)",
        "Отсутствует тип для аргумента 'func' в функции decorator (строка 65)",
        "Отсутствует тип возвращаемого значения для функции add_tag (строка 262)",
        "Отсутствует тип для аргумента 'tag' в функции add_tag (строка 262)",
        "Отсутствует тип возвращаемого значения для функции set_source (строка 278)",
        "Отсутствует тип для аргумента 'source' в функции set_source (строка 278)",
        "Отсутствует тип для аргумента 'reliability' в функции set_source (строка 278)",
        "Отсутствует тип возвращаемого значения для функции __init__ (строка 361)",
        "Отсутствует тип возвращаемого значения для функции to_dict (строка 399)",
        "Отсутствует тип возвращаемого значения для функции __init__ (строка 441)",
        "Отсутствует тип для аргумента 'name' в функции __init__ (строка 441)",
        "Отсутствует тип возвращаемого значения для функции initialize (строка 483)",
        "Отсутствует тип возвращаемого значения для функции _initialize_ai_models (строка 514)",
        "Отсутствует тип возвращаемого значения для функции _load_threat_sources (строка 617)",
        "Отсутствует тип возвращаемого значения для функции _initialize_databases (строка 679)",
        "Отсутствует тип возвращаемого значения для функции _start_background_processes (строка 720)",
        "Отсутствует тип возвращаемого значения для функции collect_threats (строка 735)",
        "Отсутствует тип возвращаемого значения для функции _collect_from_source (строка 774)",
        "Отсутствует тип для аргумента 'source_name' в функции _collect_from_source (строка 774)",
        "Отсутствует тип для аргумента 'source_config' в функции _collect_from_source (строка 774)",
        "Отсутствует тип возвращаемого значения для функции _collect_from_rss_feeds (строка 797)",
        "Отсутствует тип для аргумента 'source_config' в функции _collect_from_rss_feeds (строка 797)",
        "Отсутствует тип возвращаемого значения для функции _collect_from_api (строка 827)",
        "Отсутствует тип для аргумента 'source_config' в функции _collect_from_api (строка 827)",
        "Отсутствует тип возвращаемого значения для функции _collect_from_government_feeds (строка 861)",
        "Отсутствует тип для аргумента 'source_config' в функции _collect_from_government_feeds (строка 861)",
        "Отсутствует тип возвращаемого значения для функции _collect_from_academic_sources (строка 894)",
        "Отсутствует тип для аргумента 'source_config' в функции _collect_from_academic_sources (строка 894)",
        "Отсутствует тип возвращаемого значения для функции analyze_threats (строка 927)",
        "Отсутствует тип возвращаемого значения для функции _analyze_single_threat (строка 957)",
        "Отсутствует тип для аргумента 'threat' в функции _analyze_single_threat (строка 957)",
        "Отсутствует тип возвращаемого значения для функции _classify_threat (строка 991)",
        "Отсутствует тип для аргумента 'threat' в функции _classify_threat (строка 991)",
        "Отсутствует тип возвращаемого значения для функции _predict_severity (строка 1009)",
        "Отсутствует тип для аргумента 'threat' в функции _predict_severity (строка 1009)",
        "Отсутствует тип возвращаемого значения для функции _analyze_iocs (строка 1027)",
        "Отсутствует тип для аргумента 'threat' в функции _analyze_iocs (строка 1027)",
        "Отсутствует тип возвращаемого значения для функции _calculate_data_quality (строка 1045)",
        "Отсутствует тип возвращаемого значения для функции generate_report (строка 1089)",
        "Отсутствует тип возвращаемого значения для функции _get_threats_by_type (строка 1145)",
        "Отсутствует тип возвращаемого значения для функции _get_threats_by_severity (строка 1165)",
        "Отсутствует тип возвращаемого значения для функции _generate_recommendations (строка 1186)",
        "Отсутствует тип возвращаемого значения для функции stop (строка 1240)",
        "Отсутствует тип возвращаемого значения для функции __iter__ (строка 1259)",
        "Отсутствует тип возвращаемого значения для функции __enter__ (строка 1263)",
        "Отсутствует тип возвращаемого значения для функции __exit__ (строка 1268)",
        "Отсутствует тип для аргумента 'exc_type' в функции __exit__ (строка 1268)",
        "Отсутствует тип для аргумента 'exc_val' в функции __exit__ (строка 1268)",
        "Отсутствует тип для аргумента 'exc_tb' в функции __exit__ (строка 1268)",
        "Отсутствует тип возвращаемого значения для функции _save_data (строка 1480)",
        "Отсутствует тип возвращаемого значения для функции wrapper (строка 66)",
        "Отсутствует тип возвращаемого значения для функции __init__ (строка 138)",
        "Отсутствует тип для аргумента 'name' в функции __init__ (строка 138)",
        "Отсутствует тип возвращаемого значения для функции log_activity (строка 142)",
        "Отсутствует тип для аргумента 'message' в функции log_activity (строка 142)",
        "Отсутствует тип для аргумента 'level' в функции log_activity (строка 142)"
      ],
      "message": "Найдено 58 отсутствующих type hints"
    },
    "complexity": {
      "status": "info",
      "num_functions": 55,
      "num_classes": 12,
      "message": "Функций: 55, Классов: 12"
    },
    "dependencies": {
      "status": "info",
      "dependencies": [
        "sys",
        "asyncio",
        "hashlib",
        "functools",
        "datetime",
        "core",
        "time",
        "os",
        "enum",
        "contextlib",
        "typing",
        "json",
        "logging"
      ],
      "message": "Зависимости: 13"
    },
    "imports": {
      "status": "success",
      "message": "Импорты корректны"
    }
  },
  "summary": {
    "total_flake8_errors": 0,
    "safe_to_fix_errors": 0,
    "manual_review_errors": 0,
    "security_keywords_found": 9,
    "security_classes_found": 1,
    "sfm_functions_found": 0,
    "syntax_ok": true,
    "imports_ok": true,
    "docstrings_ok": false,
    "type_hints_ok": false
  },
  "recommendations": [
    "Добавьте функции SFM.",
    "Добавьте отсутствующие docstrings для улучшения документации.",
    "Добавьте отсутствующие type hints для улучшения читаемости и надежности."
  ],
  "fix_plan": {
    "safe_auto_fixes": [],
    "manual_fixes_required": []
  }
}