# ДОКУМЕНТАЦИЯ ФАЙЛА: network_protection_manager.py

## ОБЩАЯ ИНФОРМАЦИЯ
- **Файл**: `security/system/network_protection_manager.py`
- **Класс**: `NetworkProtectionManager`
- **Назначение**: Системный менеджер защиты сети - блокировка на уровне системы
- **Дата анализа**: 2025-01-27
- **Версия алгоритма**: 2.5

## СТРУКТУРА ФАЙЛА
- **Общее количество строк**: 293
- **Размер файла**: ~12.5 KB
- **Кодировка**: UTF-8
- **Тип файла**: Python модуль

## ИМПОРТЫ И ЗАВИСИМОСТИ
```python
import subprocess
import psutil
import logging
import json
from datetime import datetime
from typing import Dict, List, Any, Optional
from pathlib import Path
```

## ОСНОВНЫЕ КОМПОНЕНТЫ

### Класс NetworkProtectionManager
**Назначение**: Менеджер системной защиты сети

**Основные атрибуты**:
- `blocked_domains`: Список заблокированных доменов
- `blocked_ips`: Список заблокированных IP адресов
- `blocked_ports`: Список заблокированных портов
- `vpn_ports`: Порты VPN (1194, 443, 80, 53, 500, 4500, 1723, 8080, 3128, 1080)
- `tor_ports`: Порты Tor (9050, 9051, 9150, 9151)

**Основные методы**:
1. `block_vpn_globally()` - Глобальная блокировка VPN
2. `block_tor_globally()` - Глобальная блокировка Tor
3. `block_proxy_globally()` - Глобальная блокировка прокси
4. `_block_domains_in_hosts()` - Блокировка доменов через hosts
5. `kill_suspicious_processes()` - Завершение подозрительных процессов
6. `setup_dns_filtering()` - Настройка DNS фильтрации
7. `emergency_internet_lock()` - Экстренная блокировка интернета
8. `restore_internet()` - Восстановление интернета
9. `get_protection_status()` - Получение статуса защиты

## ФУНКЦИОНАЛЬНОСТЬ
- Блокировка VPN на системном уровне через iptables
- Блокировка Tor портов и доменов
- Блокировка прокси серверов
- Управление файлом hosts для блокировки доменов
- Завершение подозрительных процессов
- Настройка DNS фильтрации
- Экстренная блокировка интернета
- Мониторинг статуса защиты

## ТРЕБОВАНИЯ К СИСТЕМЕ
- Права администратора (sudo)
- Доступ к iptables
- Доступ к файлу /etc/hosts
- Модуль psutil для работы с процессами

## ПОТЕНЦИАЛЬНЫЕ ПРОБЛЕМЫ
- Требует прав администратора
- Может заблокировать легитимные сервисы
- Изменяет системные настройки
- Может нарушить работу VPN для легитимных целей

## ИНТЕГРАЦИЯ С SFM
- Функция зарегистрирована в SFM реестре
- ID функции: `network_protection_manager`
- Тип: security_system
- Уровень безопасности: high
- Статус: active

## КАЧЕСТВО КОДА
- **Ожидаемые проблемы**: 64 ошибки flake8
- **Основные типы ошибок**: W293, W291, E501, F401
- **Проблемы с форматированием**: Много лишних пробелов, длинные строки
- **Неиспользуемые импорты**: Optional из typing

## РЕКОМЕНДАЦИИ ПО УЛУЧШЕНИЮ
1. Исправить форматирование (убрать лишние пробелы)
2. Разбить длинные строки
3. Удалить неиспользуемые импорты
4. Добавить больше типизации
5. Улучшить обработку ошибок
6. Добавить логирование
7. Создать unit тесты