#!/bin/bash

echo "üì± –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï –ù–ê –†–ï–ê–õ–¨–ù–û–ú –£–°–¢–†–û–ô–°–¢–í–ï"
echo "====================================="

# –ü–µ—Ä–µ—Ö–æ–¥–∏–º –≤ –ø–∞–ø–∫—É –ø—Ä–æ–µ–∫—Ç–∞
cd "/Users/sergejhlystov/ALADDIN_NEW/mobile_apps/ALADDIN_Android_New"

echo "üìÅ –¢–µ–∫—É—â–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è: $(pwd)"

# –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º Java –∏ Android
source setup_java_env.sh

echo ""
echo "üì± –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤..."
adb devices

echo ""
echo "üìã –ò–ù–°–¢–†–£–ö–¶–ò–ò –î–õ–Ø –ü–û–î–ö–õ–Æ–ß–ï–ù–ò–Ø –£–°–¢–†–û–ô–°–¢–í–ê:"
echo "1. –í–∫–ª—é—á–∏—Ç–µ —Ä–µ–∂–∏–º —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞ –Ω–∞ Android:"
echo "   –ù–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Üí –û —Ç–µ–ª–µ—Ñ–æ–Ω–µ ‚Üí –ù–æ–º–µ—Ä —Å–±–æ—Ä–∫–∏ (–Ω–∞–∂–∞—Ç—å 7 —Ä–∞–∑)"
echo ""
echo "2. –í–∫–ª—é—á–∏—Ç–µ USB –æ—Ç–ª–∞–¥–∫—É:"
echo "   –ù–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Üí –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ ‚Üí USB –æ—Ç–ª–∞–¥–∫–∞"
echo ""
echo "3. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ —á–µ—Ä–µ–∑ USB"
echo ""
echo "4. –†–∞–∑—Ä–µ—à–∏—Ç–µ –æ—Ç–ª–∞–¥–∫—É –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ (–ø–æ—è–≤–∏—Ç—Å—è –∑–∞–ø—Ä–æ—Å)"

echo ""
read -p "–ù–∞–∂–º–∏—Ç–µ Enter –∫–æ–≥–¥–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–æ..."

echo ""
echo "üì± –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤..."
if adb devices | grep -q "device$"; then
    echo "‚úÖ –£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–æ!"
    
    echo ""
    echo "üî® –°–æ–∑–¥–∞–Ω–∏–µ debug APK –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è..."
    ./gradlew assembleDebug
    
    if [ $? -eq 0 ]; then
        echo "‚úÖ Debug APK —Å–æ–∑–¥–∞–Ω!"
        
        APK_PATH="app/build/outputs/apk/debug/app-debug.apk"
        
        echo ""
        echo "üì• –£—Å—Ç–∞–Ω–æ–≤–∫–∞ APK –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ..."
        adb install -r "$APK_PATH"
        
        if [ $? -eq 0 ]; then
            echo "‚úÖ APK —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ!"
            
            echo ""
            echo "üöÄ –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è..."
            adb shell am start -n family.aladdin.android/.MainActivity
            
            echo ""
            echo "üéâ –ü–†–ò–õ–û–ñ–ï–ù–ò–ï –ó–ê–ü–£–©–ï–ù–û –ù–ê –£–°–¢–†–û–ô–°–¢–í–ï!"
            echo ""
            echo "üì± –¢–µ–ø–µ—Ä—å –º–æ–∂–µ—Ç–µ:"
            echo "‚Ä¢ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏"
            echo "‚Ä¢ –ü—Ä–æ–≤–µ—Ä—è—Ç—å UI –Ω–∞ —Ä–µ–∞–ª—å–Ω–æ–º —ç–∫—Ä–∞–Ω–µ"
            echo "‚Ä¢ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å"
            echo "‚Ä¢ –ü—Ä–æ–≤–µ—Ä—è—Ç—å —Ä–∞–±–æ—Ç—É –≤—Å–µ—Ö 326 —Ñ—É–Ω–∫—Ü–∏–π"
            echo ""
            echo "üîß –î–ª—è –≤–Ω–µ—Å–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π:"
            echo "1. –í–Ω–µ—Å–∏—Ç–µ –ø—Ä–∞–≤–∫–∏ –≤ Android Studio"
            echo "2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —ç—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç —Å–Ω–æ–≤–∞"
            echo "3. –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ: ./quick_install.sh"
            
        else
            echo "‚ùå –û—à–∏–±–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ APK"
        fi
    else
        echo "‚ùå –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è APK"
    fi
else
    echo "‚ùå –£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –Ω–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–æ"
    echo ""
    echo "üí° –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ:"
    echo "‚Ä¢ USB –æ—Ç–ª–∞–¥–∫–∞ –≤–∫–ª—é—á–µ–Ω–∞"
    echo "‚Ä¢ –£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–æ —á–µ—Ä–µ–∑ USB"
    echo "‚Ä¢ –†–∞–∑—Ä–µ—à–µ–Ω –¥–æ—Å—Ç—É–ø –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏"
    echo ""
    echo "üîÑ –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑:"
    echo "   adb devices"
fi

echo ""
echo "üì± –ì–æ—Ç–æ–≤–æ! –¢–µ–ø–µ—Ä—å –º–æ–∂–µ—Ç–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ —Ä–µ–∞–ª—å–Ω–æ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ!"

