# üîÑ DRP - DISASTER RECOVERY PLAN (–ü–ª–∞–Ω –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –ø–æ—Å–ª–µ –ö–∞—Ç–∞—Å—Ç—Ä–æ—Ñ)

## üìã –°–û–î–ï–†–ñ–ê–ù–ò–ï

1. [–û–±–∑–æ—Ä –ø–ª–∞–Ω–∞](#–æ–±–∑–æ—Ä-–ø–ª–∞–Ω–∞)
2. [–ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –∫–∞—Ç–∞—Å—Ç—Ä–æ—Ñ](#–∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è-–∫–∞—Ç–∞—Å—Ç—Ä–æ—Ñ)
3. [–°—Ç—Ä–∞—Ç–µ–≥–∏—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è](#—Å—Ç—Ä–∞—Ç–µ–≥–∏—è-–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è)
4. [–ü—Ä–æ—Ü–µ–¥—É—Ä—ã –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è](#–ø—Ä–æ—Ü–µ–¥—É—Ä—ã-–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è)
5. [–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–ª–∞–Ω–∞](#—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ-–ø–ª–∞–Ω–∞)
6. [–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–ª–∞–Ω–∞](#–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ-–ø–ª–∞–Ω–∞)

---

## üéØ –û–ë–ó–û–† –ü–õ–ê–ù–ê

### –¶–µ–ª—å DRP
–û–±–µ—Å–ø–µ—á–∏—Ç—å –±—ã—Å—Ç—Ä–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤ ALADDIN –ø–æ—Å–ª–µ –∫–∞—Ç–∞—Å—Ç—Ä–æ—Ñ–∏—á–µ—Å–∫–∏—Ö —Å–æ–±—ã—Ç–∏–π.

### Scope (–û–±–ª–∞—Å—Ç—å –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è)
- –ü–æ–ª–Ω—ã–π –æ—Ç–∫–∞–∑ —Å–µ—Ä–≤–µ—Ä–∞
- –ü–æ—Ç–µ—Ä—è –¥–∞—Ç–∞—Ü–µ–Ω—Ç—Ä–∞
- –ö—Ä—É–ø–Ω–æ–º–∞—Å—à—Ç–∞–±–Ω—ã–µ –∫–∞—Ç–∞—Å—Ç—Ä–æ—Ñ—ã
- Ransomware –Ω–∞ –≤—Å—é –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É
- –ü—Ä–∏—Ä–æ–¥–Ω—ã–µ –∫–∞—Ç–∞—Å—Ç—Ä–æ—Ñ—ã

### Business Continuity Objectives

| –ú–µ—Ç—Ä–∏–∫–∞ | –¶–µ–ª—å | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|------|----------|
| **RTO** (Recovery Time Objective) | < 4 —á–∞—Å–∞ | –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è |
| **RPO** (Recovery Point Objective) | < 15 –º–∏–Ω—É—Ç | –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø–æ—Ç–µ—Ä—è –¥–∞–Ω–Ω—ã—Ö |
| **MTPD** (Maximum Tolerable Period of Disruption) | < 24 —á–∞—Å–∞ | –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –ø–æ—Ä–æ–≥ |

---

## üå™Ô∏è –ö–õ–ê–°–°–ò–§–ò–ö–ê–¶–ò–Ø –ö–ê–¢–ê–°–¢–†–û–§

### TIER 1: –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –ö–ê–¢–ê–°–¢–†–û–§–ê üî¥

**RTO:** 2 —á–∞—Å–∞  
**RPO:** 5 –º–∏–Ω—É—Ç

#### –ü—Ä–∏–º–µ—Ä—ã:
- –ü–æ–ª–Ω—ã–π –æ—Ç–∫–∞–∑ primary –¥–∞—Ç–∞—Ü–µ–Ω—Ç—Ä–∞
- Ransomware –Ω–∞ –≤—Å–µ—Ö —Å–µ—Ä–≤–µ—Ä–∞—Ö
- –ü–æ—Ç–µ—Ä—è –≤—Å–µ—Ö –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö
- –ö—Ä—É–ø–Ω–æ–º–∞—Å—à—Ç–∞–±–Ω—ã–π –≤–∑–ª–æ–º

#### –í–æ–∑–¥–µ–π—Å—Ç–≤–∏–µ:
- 100% downtime
- –í—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∑–∞—Ç—Ä–æ–Ω—É—Ç—ã
- –ü–æ—Ç–µ—Ä—è –±–∏–∑–Ω–µ—Å–∞ > $10K/—á–∞—Å

---

### TIER 2: –°–ï–†–¨–Å–ó–ù–ê–Ø –ö–ê–¢–ê–°–¢–†–û–§–ê üü†

**RTO:** 4 —á–∞—Å–∞  
**RPO:** 15 –º–∏–Ω—É—Ç

#### –ü—Ä–∏–º–µ—Ä—ã:
- –û—Ç–∫–∞–∑ 50%+ —Å–µ—Ä–≤–µ—Ä–æ–≤
- –ü–æ—Ç–µ—Ä—è primary –ë–î
- –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π bug –≤ production
- DDoS > 50 –ì–±–∏—Ç/—Å

#### –í–æ–∑–¥–µ–π—Å—Ç–≤–∏–µ:
- 50-80% —Ñ—É–Ω–∫—Ü–∏–π –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã
- –ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∑–∞—Ç—Ä–æ–Ω—É—Ç—ã
- –ü–æ—Ç–µ—Ä—è –±–∏–∑–Ω–µ—Å–∞ > $1K/—á–∞—Å

---

### TIER 3: –ß–ê–°–¢–ò–ß–ù–ê–Ø –ö–ê–¢–ê–°–¢–†–û–§–ê üü°

**RTO:** 8 —á–∞—Å–æ–≤  
**RPO:** 30 –º–∏–Ω—É—Ç

#### –ü—Ä–∏–º–µ—Ä—ã:
- –û—Ç–∫–∞–∑ –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
- –ü—Ä–æ–±–ª–µ–º—ã —Å single region
- Degraded performance

---

## üõ†Ô∏è –°–¢–†–ê–¢–ï–ì–ò–Ø –í–û–°–°–¢–ê–ù–û–í–õ–ï–ù–ò–Ø

### 3-2-1 BACKUP –°–¢–†–ê–¢–ï–ì–ò–Ø

```
3 - –¢–†–ò –ö–û–ü–ò–ò –î–ê–ù–ù–´–•
    ‚îú‚îÄ‚îÄ Production Database (primary)
    ‚îú‚îÄ‚îÄ Hot Standby (—Ä–µ–ø–ª–∏–∫–∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏)
    ‚îî‚îÄ‚îÄ Daily Backup (–ø–æ–ª–Ω–∞—è –∫–æ–ø–∏—è)

2 - –î–í–ê –†–ê–ó–ù–´–• –¢–ò–ü–ê –•–†–ê–ù–ò–õ–ò–©–ê
    ‚îú‚îÄ‚îÄ Local SSD (–±—ã—Å—Ç—Ä–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ)
    ‚îî‚îÄ‚îÄ Cloud Storage (–¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ)

1 - –û–î–ù–ê –ö–û–ü–ò–Ø OFFSITE
    ‚îî‚îÄ‚îÄ AWS S3 Glacier (–≥–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏ —É–¥–∞–ª—ë–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ)
```

### BACKUP SCHEDULE

| –¢–∏–ø | –ß–∞—Å—Ç–æ—Ç–∞ | Retention | –•—Ä–∞–Ω–∏–ª–∏—â–µ |
|-----|---------|-----------|-----------|
| **Full Backup** | –ï–∂–µ–¥–Ω–µ–≤–Ω–æ 02:00 UTC | 30 –¥–Ω–µ–π | S3 + Local |
| **Incremental** | –ö–∞–∂–¥—ã–µ 6 —á–∞—Å–æ–≤ | 7 –¥–Ω–µ–π | Local |
| **Transaction Log** | –ö–∞–∂–¥—ã–µ 15 –º–∏–Ω—É—Ç | 24 —á–∞—Å–∞ | Local + S3 |
| **Config Backup** | –ü—Ä–∏ –∫–∞–∂–¥–æ–º –∏–∑–º–µ–Ω–µ–Ω–∏–∏ | 90 –¥–Ω–µ–π | Git + S3 |

---

## üîÑ –ü–†–û–¶–ï–î–£–†–´ –í–û–°–°–¢–ê–ù–û–í–õ–ï–ù–ò–Ø

### –ü–†–û–¶–ï–î–£–†–ê 1: –í–û–°–°–¢–ê–ù–û–í–õ–ï–ù–ò–ï –ò–ó BACKUP

#### –®–∞–≥ 1: –û—Ü–µ–Ω–∫–∞ —Å–∏—Ç—É–∞—Ü–∏–∏ (0-15 –º–∏–Ω—É—Ç)

```bash
# 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å primary —Å–∏—Å—Ç–µ–º—ã
systemctl status aladdin-*

# 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å backup
ls -lh /backups/daily/
aws s3 ls s3://aladdin-backups/

# 3. –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–π —á–∏—Å—Ç—ã–π backup
# (–¥–æ –∏–Ω—Ü–∏–¥–µ–Ω—Ç–∞)
```

#### –®–∞–≥ 2: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è (15-30 –º–∏–Ω—É—Ç)

```bash
# 1. –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ä–µ–∑–µ—Ä–≤–Ω—ã–π —Å–µ—Ä–≤–µ—Ä (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
terraform apply -var="use_backup_server=true"

# 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–µ—Ç–µ–≤–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
ping backup-server.aladdin.family

# 3. –°–æ–∑–¥–∞—Ç—å —Ä–∞–±–æ—á–∏–π –∫–∞—Ç–∞–ª–æ–≥
mkdir -p /recovery/$(date +%Y%m%d)
cd /recovery/$(date +%Y%m%d)
```

#### –®–∞–≥ 3: –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö (30-90 –º–∏–Ω—É—Ç)

```bash
# 1. –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã
systemctl stop aladdin-api aladdin-worker

# 2. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
# –ò–∑ local backup (–±—ã—Å—Ç—Ä–æ!)
pg_restore -d aladdin_db /backups/daily/aladdin_$(date +%Y%m%d).dump

# –ò–ª–∏ –∏–∑ S3 (–º–µ–¥–ª–µ–Ω–Ω–µ–µ)
aws s3 cp s3://aladdin-backups/daily/aladdin_20251011.dump .
pg_restore -d aladdin_db aladdin_20251011.dump

# 3. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
git checkout production
git pull origin production

# 4. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã
rsync -av /backups/static/ /var/www/aladdin/static/

# 5. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å
python3 scripts/verify_data_integrity.py
```

#### –®–∞–≥ 4: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (90-105 –º–∏–Ω—É—Ç)

```bash
# 1. –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–∏—Å—ã
systemctl start aladdin-api

# 2. Health check
curl https://aladdin.family/health

# 3. Smoke tests
python3 tests/smoke_tests.py

# 4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏
- –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Å–µ–º—å–∏ ‚úÖ
- –õ–æ–≥–∏–Ω ‚úÖ
- API endpoints ‚úÖ
- Payment ‚úÖ
```

#### –®–∞–≥ 5: –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ (105-120 –º–∏–Ω—É—Ç)

```
1. 10% —Ç—Ä–∞—Ñ–∏–∫–∞ ‚Üí –¢–µ—Å—Ç 10 –º–∏–Ω—É—Ç ‚Üí OK? ‚úÖ
2. 25% —Ç—Ä–∞—Ñ–∏–∫–∞ ‚Üí –¢–µ—Å—Ç 10 –º–∏–Ω—É—Ç ‚Üí OK? ‚úÖ
3. 50% —Ç—Ä–∞—Ñ–∏–∫–∞ ‚Üí –¢–µ—Å—Ç 15 –º–∏–Ω—É—Ç ‚Üí OK? ‚úÖ
4. 100% —Ç—Ä–∞—Ñ–∏–∫–∞ ‚Üí FULL RECOVERY! üéâ
```

---

### –ü–†–û–¶–ï–î–£–†–ê 2: FAILOVER –ù–ê –†–ï–ó–ï–†–í–ù–´–ô –°–ï–†–í–ï–†

#### –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:
- Primary —Å–µ—Ä–≤–µ—Ä –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
- –§–∏–∑–∏—á–µ—Å–∫–∏–π –æ—Ç–∫–∞–∑ hardware
- –ü—Ä–æ–±–ª–µ–º—ã —Å –¥–∞—Ç–∞—Ü–µ–Ω—Ç—Ä–æ–º

#### –ü—Ä–æ—Ü–µ—Å—Å (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π!):

```python
# monitoring/health_check.py

async def check_primary_health():
    try:
        response = await httpx.get("https://api.aladdin.family/health")
        if response.status_code != 200:
            # Primary down!
            await trigger_failover()
    except:
        # Primary unreachable!
        await trigger_failover()

async def trigger_failover():
    # 1. Activate standby server
    await activate_standby()
    
    # 2. Update DNS (Cloudflare API)
    await update_dns(
        record="api.aladdin.family",
        value="backup-api-ip"
    )
    
    # 3. Sync data from last backup
    await sync_from_backup()
    
    # 4. Start services
    await start_all_services()
    
    # 5. Alert team
    await send_alert("Failover to backup server completed!")
```

**–í—Ä–µ–º—è failover:** 2-5 –º–∏–Ω—É—Ç (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏!)

---

### –ü–†–û–¶–ï–î–£–†–ê 3: –í–û–°–°–¢–ê–ù–û–í–õ–ï–ù–ò–ï –ü–û–°–õ–ï RANSOMWARE

#### –ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å: –ú–ê–ö–°–ò–ú–ê–õ–¨–ù–ê–Ø üî¥

```
‚ö†Ô∏è –ù–ï –ü–õ–ê–¢–ò–¢–¨ –í–´–ö–£–ü! ‚ùå

–î–ï–ô–°–¢–í–ò–Ø:

1. –ò–ó–û–õ–Ø–¶–ò–Ø (0-15 –º–∏–Ω):
   ‚Üí –û—Ç–∫–ª—é—á–∏—Ç—å –≤—Å–µ –∑–∞—Ä–∞–∂—ë–Ω–Ω—ã–µ —Å–µ—Ä–≤–µ—Ä—ã
   ‚Üí –ò–∑–æ–ª–∏—Ä–æ–≤–∞—Ç—å —Å–µ—Ç—å
   ‚Üí –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç–∏—Ç—å —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ

2. –û–¶–ï–ù–ö–ê (15-30 –º–∏–Ω):
   ‚Üí –ö–∞–∫–∏–µ –¥–∞–Ω–Ω—ã–µ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω—ã?
   ‚Üí –ö–æ–≥–¥–∞ –Ω–∞—á–∞–ª–æ—Å—å —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ?
   ‚Üí –ü–æ—Å–ª–µ–¥–Ω–∏–π —á–∏—Å—Ç—ã–π backup?

3. –í–û–°–°–¢–ê–ù–û–í–õ–ï–ù–ò–ï (30-180 –º–∏–Ω):
   ‚Üí –†–∞–∑–≤–µ—Ä–Ω—É—Ç—å —á–∏—Å—Ç—ã–µ —Å–µ—Ä–≤–µ—Ä—ã
   ‚Üí –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–∑ backup (–¥–æ –∑–∞—Ä–∞–∂–µ–Ω–∏—è)
   ‚Üí –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞ malware

4. –£–ö–†–ï–ü–õ–ï–ù–ò–ï (180-240 –º–∏–Ω):
   ‚Üí –ó–∞–∫—Ä—ã—Ç—å –≤–µ–∫—Ç–æ—Ä –∞—Ç–∞–∫–∏
   ‚Üí –û–±–Ω–æ–≤–∏—Ç—å –≤—Å–µ –ø–∞—Ä–æ–ª–∏
   ‚Üí –£—Å–∏–ª–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

5. –ü–†–û–í–ï–†–ö–ê (240-300 –º–∏–Ω):
   ‚Üí –ü–æ–ª–Ω–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
   ‚Üí –¢–µ—Å—Ç –≤—Å–µ—Ö —Ñ—É–Ω–∫—Ü–∏–π
   ‚Üí Audit –ª–æ–≥–æ–≤
```

---

### –ü–†–û–¶–ï–î–£–†–ê 4: –í–û–°–°–¢–ê–ù–û–í–õ–ï–ù–ò–ï –ë–ê–ó–´ –î–ê–ù–ù–´–•

#### Point-in-Time Recovery (PITR)

```bash
# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –º–æ–º–µ–Ω—Ç –≤—Ä–µ–º–µ–Ω–∏

# 1. –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Ü–µ–ª–µ–≤–æ–µ –≤—Ä–µ–º—è
TARGET_TIME="2025-10-11 14:30:00 UTC"

# 2. –ù–∞–π—Ç–∏ –±–ª–∏–∂–∞–π—à–∏–π full backup
BACKUP_DATE="2025-10-11 02:00:00 UTC"

# 3. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å full backup
pg_restore -d aladdin_db /backups/full/aladdin_20251011_0200.dump

# 4. –ü—Ä–∏–º–µ–Ω–∏—Ç—å transaction logs –¥–æ —Ü–µ–ª–µ–≤–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏
for log in /backups/wal/202510110200_*.wal; do
    if [[ $(stat -f %m "$log") -le $(date -j -f "%Y-%m-%d %H:%M:%S" "$TARGET_TIME" +%s) ]]; then
        pg_waldump "$log" | psql aladdin_db
    fi
done

# 5. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ
psql -d aladdin_db -c "SELECT MAX(created_at) FROM families;"
```

**–¢–æ—á–Ω–æ—Å—Ç—å –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è:** –¥–æ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö 15 –º–∏–Ω—É—Ç!

---

## üèóÔ∏è –†–ï–ó–ï–†–í–ù–ê–Ø –ò–ù–§–†–ê–°–¢–†–£–ö–¢–£–†–ê

### Primary Infrastructure

```
Region: Europe (Frankfurt)
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  PRODUCTION SERVERS                         ‚îÇ
‚îÇ                                             ‚îÇ
‚îÇ  ‚Ä¢ api-1.aladdin.family (Load: 70%)        ‚îÇ
‚îÇ  ‚Ä¢ api-2.aladdin.family (Load: 30%)        ‚îÇ
‚îÇ  ‚Ä¢ db-primary (Hot Standby ready)          ‚îÇ
‚îÇ  ‚Ä¢ redis-primary (Sentinel cluster)        ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### Backup Infrastructure

```
Region: Russia (Moscow) + Cloud (S3)
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  BACKUP SERVERS (Cold Standby)              ‚îÇ
‚îÇ                                             ‚îÇ
‚îÇ  ‚Ä¢ backup-api.aladdin.family (OFF)         ‚îÇ
‚îÇ  ‚Ä¢ db-backup (Standby, sync –∫–∞–∂–¥—ã–µ 15 –º–∏–Ω) ‚îÇ
‚îÇ  ‚Ä¢ S3 Glacier (Long-term storage)          ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

–í—Ä–µ–º—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏: 5-10 –º–∏–Ω—É—Ç
```

---

## üìä RECOVERY SCENARIOS

### –°—Ü–µ–Ω–∞—Ä–∏–π A: –ü–æ–ª–Ω–∞—è –ø–æ—Ç–µ—Ä—è PRIMARY –¥–∞—Ç–∞—Ü–µ–Ω—Ç—Ä–∞

**–ü—Ä–∏—á–∏–Ω–∞:** –ü–æ–∂–∞—Ä / –ù–∞–≤–æ–¥–Ω–µ–Ω–∏–µ / –û—Ç–∫–ª—é—á–µ–Ω–∏–µ —ç–ª–µ–∫—Ç—Ä–∏—á–µ—Å—Ç–≤–∞

**RTO:** 4 —á–∞—Å–∞  
**RPO:** 15 –º–∏–Ω—É—Ç

```
–î–ï–ô–°–¢–í–ò–Ø:

0:00 - –û–ë–ù–ê–†–£–ñ–ï–ù–ò–ï
     ‚Üí –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç: Primary –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
     ‚Üí –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π health check fails
     ‚Üí Alert –≤—Å–µ–π –∫–æ–º–∞–Ω–¥–µ

0:05 - –ê–ö–¢–ò–í–ê–¶–ò–Ø BACKUP
     ‚Üí –ó–∞–ø—É—Å–∫ backup-api —Å–µ—Ä–≤–µ—Ä–∞ (AWS EC2)
     ‚Üí –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ë–î –∏–∑ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ backup
     ‚Üí –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö

0:30 - –ü–ï–†–ï–ö–õ–Æ–ß–ï–ù–ò–ï DNS
     ‚Üí Cloudflare API: –æ–±–Ω–æ–≤–∏—Ç—å A records
     ‚Üí api.aladdin.family ‚Üí backup-api-ip
     ‚Üí TTL: 60 —Å–µ–∫—É–Ω–¥ (–±—ã—Å—Ç—Ä–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ)

0:35 - –ü–†–û–í–ï–†–ö–ê –°–ï–†–í–ò–°–û–í
     ‚Üí Health checks
     ‚Üí Smoke tests
     ‚Üí Critical functions test

1:00 - –ü–û–°–¢–ï–ü–ï–ù–ù–û–ï –í–û–°–°–¢–ê–ù–û–í–õ–ï–ù–ò–ï –¢–†–ê–§–ò–ö–ê
     ‚Üí 10% ‚Üí —Ç–µ—Å—Ç 15 –º–∏–Ω—É—Ç
     ‚Üí 50% ‚Üí —Ç–µ—Å—Ç 20 –º–∏–Ω—É—Ç
     ‚Üí 100% ‚Üí –ø–æ–ª–Ω–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ

4:00 - –§–ò–ù–ê–õ–ò–ó–ê–¶–ò–Ø
     ‚Üí –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —É—Å–∏–ª–µ–Ω–Ω—ã–π (48 —á–∞—Å–æ–≤)
     ‚Üí Post-mortem analysis
     ‚Üí –ü–ª–∞–Ω –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è primary
```

---

### –°—Ü–µ–Ω–∞—Ä–∏–π B: –ü–æ—Ç–µ—Ä—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

**–ü—Ä–∏—á–∏–Ω–∞:** Corruption / Ransomware / Hardware failure

**RTO:** 2 —á–∞—Å–∞  
**RPO:** 15 –º–∏–Ω—É—Ç

```
–î–ï–ô–°–¢–í–ò–Ø:

1. STOP ALL WRITES (0-5 –º–∏–Ω):
   systemctl stop aladdin-api
   systemctl stop aladdin-worker

2. ASSESS DAMAGE (5-15 –º–∏–Ω):
   # –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –º–æ–∂–Ω–æ —Å–ø–∞—Å—Ç–∏
   pg_dump aladdin_db > /tmp/corrupted_db.dump
   
   # –ê–Ω–∞–ª–∏–∑
   pg_restore --list /tmp/corrupted_db.dump

3. RESTORE FROM BACKUP (15-60 –º–∏–Ω):
   # –ü–æ—Å–ª–µ–¥–Ω–∏–π daily backup
   pg_restore -d aladdin_db_new /backups/daily/latest.dump
   
   # –ü—Ä–∏–º–µ–Ω–∏—Ç—å transaction logs
   for log in /backups/wal/*.wal; do
       pg_waldump "$log" | psql aladdin_db_new
   done

4. VERIFY DATA (60-90 –º–∏–Ω):
   python3 scripts/verify_db_integrity.py
   
   # –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ç–∞–±–ª–∏—Ü—ã
   SELECT COUNT(*) FROM families;
   SELECT COUNT(*) FROM members;
   SELECT COUNT(*) FROM sessions;

5. SWITCH TO NEW DB (90-120 –º–∏–Ω):
   # Update config
   DB_NAME=aladdin_db_new
   
   # Restart services
   systemctl start aladdin-api
   systemctl start aladdin-worker
```

---

### –°—Ü–µ–Ω–∞—Ä–∏–π C: Ransomware –Ω–∞ –≤—Å–µ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–µ

**–ü—Ä–∏—á–∏–Ω–∞:** –ú–∞—Å—Å–æ–≤–∞—è –∞—Ç–∞–∫–∞ —à–∏—Ñ—Ä–æ–≤–∞–ª—å—â–∏–∫–∞

**RTO:** 6 —á–∞—Å–æ–≤  
**RPO:** 1 —á–∞—Å (worst case)

```
–ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –ü–õ–ê–ù:

0:00 - –û–ë–ù–ê–†–£–ñ–ï–ù–ò–ï
     ‚Üí –§–∞–π–ª—ã –Ω–∞—á–∏–Ω–∞—é—Ç —à–∏—Ñ—Ä–æ–≤–∞—Ç—å—Å—è
     ‚Üí –ê–Ω—Ç–∏–≤–∏—Ä—É—Å –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç ransomware
     ‚Üí –ù–ï–ú–ï–î–õ–ï–ù–ù–´–ô ALARM!

0:02 - –ò–ó–û–õ–Ø–¶–ò–Ø
     ‚Üí systemctl stop ALL services
     ‚Üí –û—Ç–∫–ª—é—á–∏—Ç—å —Å–µ—Ç—å: ifconfig eth0 down
     ‚Üí –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç–∏—Ç—å —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ

0:10 - FORENSICS
     ‚Üí Snapshot –≤—Å–µ—Ö –¥–∏—Å–∫–æ–≤ (–¥–ª—è –∞–Ω–∞–ª–∏–∑–∞)
     ‚Üí dd if=/dev/sda of=/forensic/disk_image.dd
     ‚Üí –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤—Å–µ –ª–æ–≥–∏

0:30 - –ß–ò–°–¢–ê–Ø –£–°–¢–ê–ù–û–í–ö–ê
     ‚Üí –†–∞–∑–≤–µ—Ä–Ω—É—Ç—å –Ω–æ–≤—ã–µ —Å–µ—Ä–≤–µ—Ä—ã (clean OS)
     ‚Üí –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å ALADDIN –∏–∑ Git (–ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–π commit)
     ‚Üí –ë–ï–ó –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –∏—Å–ø–æ–ª–Ω—è–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤!

1:00 - –í–û–°–°–¢–ê–ù–û–í–õ–ï–ù–ò–ï –î–ê–ù–ù–´–•
     ‚Üí –¢–æ–ª—å–∫–æ –¥–∞–Ω–Ω—ã–µ (–Ω–µ –∫–æ–¥!)
     ‚Üí –ò–∑ backup –¥–æ –∑–∞—Ä–∞–∂–µ–Ω–∏—è
     ‚Üí –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥–æ–≥–æ —Ñ–∞–π–ª–∞

3:00 - –ü–†–û–í–ï–†–ö–ê –ù–ê MALWARE
     ‚Üí –ü–æ–ª–Ω–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
     ‚Üí –ü—Ä–æ–≤–µ—Ä–∫–∞ integrity
     ‚Üí Hash verification

4:00 - –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï
     ‚Üí Smoke tests
     ‚Üí Security audit
     ‚Üí Performance test

6:00 - –ü–û–°–¢–ï–ü–ï–ù–ù–´–ô –ó–ê–ü–£–°–ö
     ‚Üí 10% ‚Üí 50% ‚Üí 100%
     ‚Üí –£—Å–∏–ª–µ–Ω–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ 72 —á–∞—Å–∞
```

---

## üóÇÔ∏è BACKUP CATALOG

### –ß—Ç–æ –±—ç–∫–∞–ø–∏—Ç—Å—è:

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –ú–µ—Ç–æ–¥ | –ß–∞—Å—Ç–æ—Ç–∞ | Retention |
|-----------|-------|---------|-----------|
| **PostgreSQL –ë–î** | pg_dump + WAL | 15 –º–∏–Ω—É—Ç | 30 –¥–Ω–µ–π |
| **Redis (sessions)** | RDB snapshot | 1 —á–∞—Å | 7 –¥–Ω–µ–π |
| **Config —Ñ–∞–π–ª—ã** | Git commit | Real-time | 90 –¥–Ω–µ–π |
| **–õ–æ–≥–∏** | rsync | 6 —á–∞—Å–æ–≤ | 30 –¥–Ω–µ–π |
| **–°—Ç–∞—Ç–∏–∫–∞** | rsync | 1 –¥–µ–Ω—å | 14 –¥–Ω–µ–π |
| **Code** | Git tags | Release | –ë–µ—Å–∫–æ–Ω–µ—á–Ω–æ |

### –ß—Ç–æ –ù–ï –±—ç–∫–∞–ø–∏—Ç—Å—è:

- ‚ùå –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã (cache, tmp)
- ‚ùå Build artifacts
- ‚ùå node_modules
- ‚ùå –õ–æ–∫–∞–ª—å–Ω—ã–µ —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ

---

## üß™ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï DRP

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã:

#### 1. Quarterly Recovery Drill (–ö–≤–∞—Ä—Ç–∞–ª—å–Ω—ã–µ —É—á–µ–Ω–∏—è)

**–°—Ü–µ–Ω–∞—Ä–∏–π:**
1. –°–∏–º—É–ª—è—Ü–∏—è –∫–∞—Ç–∞—Å—Ç—Ä–æ—Ñ—ã (–Ω–∞–ø—Ä. –ø–æ—Ç–µ—Ä—è primary DB)
2. –ö–æ–º–∞–Ω–¥–∞ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Å–∏—Å—Ç–µ–º—É –ø–æ DRP
3. –ó–∞—Å–µ–∫–∞–µ—Ç—Å—è –≤—Ä–µ–º—è (RTO)
4. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –ø–æ—Ç–µ—Ä—è –¥–∞–Ω–Ω—ã—Ö (RPO)

**–¶–µ–ª—å:**
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–æ—Ü–µ–¥—É—Ä—ã
- –ù–∞—Ç—Ä–µ–Ω–∏—Ä–æ–≤–∞—Ç—å –∫–æ–º–∞–Ω–¥—É
- –ù–∞–π—Ç–∏ —É–∑–∫–∏–µ –º–µ—Å—Ç–∞

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ:** 2025-09-15  
**–†–µ–∑—É–ª—å—Ç–∞—Ç:** RTO 3h 20min, RPO 12 –º–∏–Ω—É—Ç ‚úÖ  
**–°–ª–µ–¥—É—é—â–µ–µ:** 2025-12-15

---

#### 2. Monthly Backup Verification (–ï–∂–µ–º–µ—Å—è—á–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ backup)

```bash
#!/bin/bash
# –¢–µ—Å—Ç –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –∏–∑ backup

# 1. –í—ã–±—Ä–∞—Ç—å —Å–ª—É—á–∞–π–Ω—ã–π backup
BACKUP=$(ls /backups/daily/ | shuf -n 1)

# 2. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤ —Ç–µ—Å—Ç–æ–≤—É—é –ë–î
pg_restore -d test_db /backups/daily/$BACKUP

# 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–∞–Ω–Ω—ã–µ
psql -d test_db -c "SELECT COUNT(*) FROM families;"

# 4. –ï—Å–ª–∏ OK ‚Üí backup –≤–∞–ª–∏–¥–Ω—ã–π ‚úÖ
# 5. –ï—Å–ª–∏ –æ—à–∏–±–∫–∞ ‚Üí ALARM! ‚ùå
```

---

#### 3. Annual Disaster Simulation (–ì–æ–¥–æ–≤–∞—è —Å–∏–º—É–ª—è—Ü–∏—è –∫–∞—Ç–∞—Å—Ç—Ä–æ—Ñ—ã)

**–ü–æ–ª–Ω–æ–º–∞—Å—à—Ç–∞–±–Ω–æ–µ —É—á–µ–Ω–∏–µ:**
- –°–∏–º—É–ª—è—Ü–∏—è Tier 1 –∫–∞—Ç–∞—Å—Ç—Ä–æ—Ñ—ã
- –í–æ–≤–ª–µ—á–µ–Ω–∏–µ –≤—Å–µ–π –∫–æ–º–∞–Ω–¥—ã
- –†–µ–∞–ª—å–Ω–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ backup (–≤ test environment)
- –ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è
- –î–µ—Ç–∞–ª—å–Ω—ã–π –æ—Ç—á—ë—Ç

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ:** 2025-01-15  
**–°–ª–µ–¥—É—é—â–µ–µ:** 2026-01-15

---

## üìû –ö–û–ù–¢–ê–ö–¢–´ –ò ESCALATION

### Emergency Contact List

| –†–æ–ª—å | –ö–æ–Ω—Ç–∞–∫—Ç | –î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å |
|------|---------|-------------|
| **DR Commander** | +7 XXX XXX-XX-XX | 24/7 |
| **Lead DevOps** | +7 XXX XXX-XX-XX | 24/7 |
| **Database Admin** | +7 XXX XXX-XX-XX | On-call |
| **Security Lead** | security@aladdin.family | 24/7 |

### External Vendors

| Vendor | Service | Contact | SLA |
|--------|---------|---------|-----|
| **AWS** | Cloud Infrastructure | aws-support | 1 hour |
| **Cloudflare** | CDN + Security | cf-support | 2 hours |
| **–†–µ–≥–∏—Å—Ç—Ä–∞—Ç–æ—Ä** | Domain | support@ | 4 hours |

---

## üîê –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–¨ BACKUP

### –ó–∞—â–∏—Ç–∞ backup –æ—Ç Ransomware:

```
1. AIR-GAPPED BACKUP:
   ‚úÖ Offsite –∫–æ–ø–∏—è –≤ S3 Glacier
   ‚úÖ Immutable (–Ω–µ–ª—å–∑—è —É–¥–∞–ª–∏—Ç—å/–∏–∑–º–µ–Ω–∏—Ç—å)
   ‚úÖ –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–∫–ª—é—á–µ–Ω–æ

2. ENCRYPTED BACKUPS:
   ‚úÖ AES-256 —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ
   ‚úÖ –ö–ª—é—á–∏ –≤ AWS KMS
   ‚úÖ Separate credentials

3. ACCESS CONTROL:
   ‚úÖ MFA required –¥–ª—è –¥–æ—Å—Ç—É–ø–∞
   ‚úÖ Audit log –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
   ‚úÖ –¢–æ–ª—å–∫–æ 2 —á–µ–ª–æ–≤–µ–∫–∞ –∏–º–µ—é—Ç –¥–æ—Å—Ç—É–ø
```

---

## üìà CONTINUOUS IMPROVEMENT

### –ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ recovery:

1. **Post-Recovery Review** (–≤ —Ç–µ—á–µ–Ω–∏–µ 24 —á–∞—Å–æ–≤)
   - –ß—Ç–æ —Å—Ä–∞–±–æ—Ç–∞–ª–æ?
   - –ß—Ç–æ –º–æ–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å?
   - –°–∫–æ–ª—å–∫–æ –≤—Ä–µ–º–µ–Ω–∏ –∑–∞–Ω—è–ª–æ?
   - RTO/RPO —Å–æ–±–ª—é–¥–µ–Ω—ã?

2. **Update DRP** (–≤ —Ç–µ—á–µ–Ω–∏–µ –Ω–µ–¥–µ–ª–∏)
   - –û–±–Ω–æ–≤–∏—Ç—å –ø—Ä–æ—Ü–µ–¥—É—Ä—ã
   - –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏
   - –£–ª—É—á—à–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—é

3. **Train Team** (–≤ —Ç–µ—á–µ–Ω–∏–µ –º–µ—Å—è—Ü–∞)
   - –û–±—É—á–µ–Ω–∏–µ –Ω–∞ –æ—à–∏–±–∫–∞—Ö
   - –ù–æ–≤—ã–µ –ø—Ä–æ—Ü–µ–¥—É—Ä—ã
   - –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ drill

---

## üìä –ú–ï–¢–†–ò–ö–ò RECOVERY

### –¶–µ–ª–µ–≤—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏:

| –ú–µ—Ç—Ä–∏–∫–∞ | Tier 1 | Tier 2 | Tier 3 |
|---------|--------|--------|--------|
| **RTO** | < 2 —á–∞—Å–∞ | < 4 —á–∞—Å–∞ | < 8 —á–∞—Å–æ–≤ |
| **RPO** | < 5 –º–∏–Ω—É—Ç | < 15 –º–∏–Ω—É—Ç | < 30 –º–∏–Ω—É—Ç |
| **Data Loss** | < 0.01% | < 0.1% | < 1% |
| **Success Rate** | > 99% | > 98% | > 95% |

### –¢–µ–∫—É—â–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã (2025 Q3):

| –ú–µ—Ç—Ä–∏–∫–∞ | –§–∞–∫—Ç | –°—Ç–∞—Ç—É—Å |
|---------|------|--------|
| **Avg RTO** | 3h 20min | ‚ö†Ô∏è –ù—É–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å –¥–æ 2h |
| **Avg RPO** | 12 –º–∏–Ω—É—Ç | ‚úÖ –¶–µ–ª—å –¥–æ—Å—Ç–∏–≥–Ω—É—Ç–∞ |
| **Recovery Success Rate** | 100% (3/3) | ‚úÖ –û—Ç–ª–∏—á–Ω–æ |
| **False Alarms** | 2% | ‚úÖ –ü—Ä–∏–µ–º–ª–µ–º–æ |

---

## üîó INTEGRATION –° –°–ò–°–¢–ï–ú–ê–ú–ò

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ:

```python
# security/reactive/recovery_service.py

class RecoveryService:
    """
    –°–ª—É–∂–±–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è
    
    –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:
    - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π failover
    - Self-healing –¥–ª—è minor issues
    - Orchestration –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è
    - –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ recovery –ø—Ä–æ—Ü–µ—Å—Å–∞
    """
    
    async def auto_recover(self, incident_id):
        # 1. –û—Ü–µ–Ω–∏—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å auto-recovery
        if self.can_auto_recover(incident_id):
            # 2. –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
            await self.execute_recovery(incident_id)
            
            # 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç
            if await self.verify_recovery():
                return RecoveryStatus.SUCCESS
        else:
            # –¢—Ä–µ–±—É–µ—Ç—Å—è —Ä—É—á–Ω–æ–µ –≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–æ
            await self.escalate_to_human()
```

---

## üìù –ß–ï–ö–õ–ò–°–¢–´

### Pre-Disaster Checklist (–ü—Ä–µ–≤–µ–Ω—Ç–∏–≤–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞)

```
–ï–ñ–ï–î–ù–ï–í–ù–û:
‚òë Backup —É—Å–ø–µ—à–Ω–æ –∑–∞–≤–µ—Ä—à—ë–Ω
‚òë Backup integrity –ø—Ä–æ–≤–µ—Ä–µ–Ω
‚òë Disk space > 20% free
‚òë Monitoring —Ä–∞–±–æ—Ç–∞–µ—Ç

–ï–ñ–ï–ù–ï–î–ï–õ–¨–ù–û:
‚òë Test restore (—Å–ª—É—á–∞–π–Ω—ã–π backup)
‚òë Review error logs
‚òë Update recovery procedures
‚òë Check failover –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å

–ï–ñ–ï–ú–ï–°–Ø–ß–ù–û:
‚òë Full DR drill
‚òë Review contacts list
‚òë Update documentation
‚òë Train new team members

–ï–ñ–ï–ö–í–ê–†–¢–ê–õ–¨–ù–û:
‚òë Disaster simulation
‚òë Update RTO/RPO targets
‚òë Review vendor SLAs
‚òë Audit access controls
```

---

## üöÄ –ë–´–°–¢–†–´–ô –°–¢–ê–†–¢ (EMERGENCY)

### –ï—Å–ª–∏ –∫–∞—Ç–∞—Å—Ç—Ä–æ—Ñ–∞ –°–ï–ô–ß–ê–°! üî•

```
1. STOP! –ù–µ –ø–∞–Ω–∏–∫—É–π—Ç–µ! ‚è∏Ô∏è

2. ASSESS (2 –º–∏–Ω—É—Ç—ã):
   ‚ñ° –ß—Ç–æ —Å–ª—É—á–∏–ª–æ—Å—å?
   ‚ñ° Tier 1/2/3?
   ‚ñ° –°–∫–æ–ª—å–∫–æ –∑–∞—Ç—Ä–æ–Ω—É—Ç–æ?

3. ACTIVATE TEAM (2 –º–∏–Ω—É—Ç—ã):
   ‚ñ° Telegram: @all "DISASTER! Type: X"
   ‚ñ° Create war room
   ‚ñ° Start incident log

4. FOLLOW PROCEDURE (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç Tier):
   ‚ñ° Tier 1 ‚Üí –°—Ü–µ–Ω–∞—Ä–∏–π A/B/C
   ‚ñ° Tier 2 ‚Üí –ü—Ä–æ—Ü–µ–¥—É—Ä–∞ 1/2
   ‚ñ° Tier 3 ‚Üí –ü—Ä–æ—Ü–µ–¥—É—Ä–∞ 4

5. DOCUMENT EVERYTHING:
   ‚ñ° Screenshots
   ‚ñ° Commands executed
   ‚ñ° Timeline
   ‚ñ° Decisions made
```

---

## üîó –°–í–Ø–ó–ê–ù–ù–´–ï –î–û–ö–£–ú–ï–ù–¢–´

- [IRP - Incident Response Plan](IRP_INCIDENT_RESPONSE_PLAN.md)
- [Recovery Service Documentation](../security/recovery_service_documentation.md)
- [Backup Procedures](../security/backups/BACKUP_PROCEDURES.md)
- [3-2-1 Backup Strategy](../security/backups/3-2-1_STRATEGY.md)

---

## üìÖ –ò–°–¢–û–†–ò–Ø –í–ï–†–°–ò–ô

| –í–µ—Ä—Å–∏—è | –î–∞—Ç–∞ | –ò–∑–º–µ–Ω–µ–Ω–∏—è |
|--------|------|-----------|
| 1.0.0 | 2025-10-11 | –°–æ–∑–¥–∞–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ DRP |
| 0.9.0 | 2025-09-22 | –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ recovery procedures |
| 0.8.0 | 2025-09-17 | –î–æ–±–∞–≤–ª–µ–Ω–∏–µ 3-2-1 backup —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ |

---

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –î–ï–ô–°–¢–í–£–Æ–©–ò–ô  
**–ü–æ—Å–ª–µ–¥–Ω–∏–π test:** 2025-09-15 (RTO 3h 20min, RPO 12min)  
**–°–ª–µ–¥—É—é—â–∏–π review:** 2025-11-11  
**–°–ª–µ–¥—É—é—â–∏–π drill:** 2025-12-15  
**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π:** DevOps Team + Security Team



