name: iOS Simple Test 10 - Complete Test

on:
  push:
    branches: [ main ]
    paths: [ 'mobile_apps/ALADDIN_iOS/simple_test_10.txt' ]

jobs:
  complete-test:
    runs-on: macos-latest
    timeout-minutes: 20
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v4
      
    - name: Setup Xcode
      uses: maxim-lobanov/setup-xcode@v1
      with:
        xcode-version: '16.0.0'
        
    - name: Test 10 - Complete Test
      run: |
        echo "üß™ –¢–ï–°–¢ 10: –ü–û–õ–ù–´–ô –¢–ï–°–¢"
        echo "================================"
        
        cd mobile_apps/ALADDIN_iOS
        
        echo "üéØ –ü–û–õ–ù–´–ô –¢–ï–°–¢ –í–°–ï–• –†–ï–®–ï–ù–ò–ô"
        echo "============================="
        
        # –û—á–∏—â–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–µ —Å–±–æ—Ä–∫–∏
        rm -rf build/
        
        echo "1Ô∏è‚É£ –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç—É–ø–Ω—ã–µ —Å–∏–º—É–ª—è—Ç–æ—Ä—ã:"
        xcrun simctl list devices available | grep "iPhone" | head -3
        
        echo ""
        echo "2Ô∏è‚É£ –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø—Ä–æ–µ–∫—Ç:"
        xcodebuild -project ALADDIN.xcodeproj -list | head -10
        
        echo ""
        echo "3Ô∏è‚É£ –¢–µ—Å—Ç–∏—Ä—É–µ–º –≤—Å–µ –≤–æ–∑–º–æ–∂–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è:"
        
        # –†–µ—à–µ–Ω–∏–µ 1: –¢–æ–ª—å–∫–æ —Å—Ö–µ–º–∞
        echo ""
        echo "–†–µ—à–µ–Ω–∏–µ 1: –¢–æ–ª—å–∫–æ —Å—Ö–µ–º–∞ (–±–µ–∑ destination)"
        if xcodebuild -project ALADDIN.xcodeproj -scheme ALADDIN build; then
          echo "‚úÖ –†–µ—à–µ–Ω–∏–µ 1 —Ä–∞–±–æ—Ç–∞–µ—Ç"
          ls -la build/
          find build/ -name "*.app" -type d
          exit 0
        else
          echo "‚ùå –†–µ—à–µ–Ω–∏–µ 1 –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç"
        fi
        
        rm -rf build/
        
        # –†–µ—à–µ–Ω–∏–µ 2: Platform Simulator
        echo ""
        echo "–†–µ—à–µ–Ω–∏–µ 2: platform=iOS Simulator"
        if xcodebuild -project ALADDIN.xcodeproj -scheme ALADDIN -destination "platform=iOS Simulator" build; then
          echo "‚úÖ –†–µ—à–µ–Ω–∏–µ 2 —Ä–∞–±–æ—Ç–∞–µ—Ç"
          ls -la build/
          find build/ -name "*.app" -type d
          exit 0
        else
          echo "‚ùå –†–µ—à–µ–Ω–∏–µ 2 –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç"
        fi
        
        rm -rf build/
        
        # –†–µ—à–µ–Ω–∏–µ 3: –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Å–∏–º—É–ª—è—Ç–æ—Ä
        echo ""
        echo "–†–µ—à–µ–Ω–∏–µ 3: platform=iOS Simulator,name=iPhone 15"
        if xcodebuild -project ALADDIN.xcodeproj -scheme ALADDIN -destination "platform=iOS Simulator,name=iPhone 15" build; then
          echo "‚úÖ –†–µ—à–µ–Ω–∏–µ 3 —Ä–∞–±–æ—Ç–∞–µ—Ç"
          ls -la build/
          find build/ -name "*.app" -type d
          exit 0
        else
          echo "‚ùå –†–µ—à–µ–Ω–∏–µ 3 –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç"
        fi
        
        rm -rf build/
        
        # –†–µ—à–µ–Ω–∏–µ 4: Release –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
        echo ""
        echo "–†–µ—à–µ–Ω–∏–µ 4: Release –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è"
        if xcodebuild -project ALADDIN.xcodeproj -scheme ALADDIN -configuration Release -destination "platform=iOS Simulator,name=iPhone 15" build; then
          echo "‚úÖ –†–µ—à–µ–Ω–∏–µ 4 —Ä–∞–±–æ—Ç–∞–µ—Ç"
          ls -la build/
          find build/ -name "*.app" -type d
          exit 0
        else
          echo "‚ùå –†–µ—à–µ–Ω–∏–µ 4 –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç"
        fi
        
        rm -rf build/
        
        # –†–µ—à–µ–Ω–∏–µ 5: Generic platform
        echo ""
        echo "–†–µ—à–µ–Ω–∏–µ 5: generic/platform=iOS Simulator"
        if xcodebuild -project ALADDIN.xcodeproj -scheme ALADDIN -destination "generic/platform=iOS Simulator" build; then
          echo "‚úÖ –†–µ—à–µ–Ω–∏–µ 5 —Ä–∞–±–æ—Ç–∞–µ—Ç"
          ls -la build/
          find build/ -name "*.app" -type d
          exit 0
        else
          echo "‚ùå –†–µ—à–µ–Ω–∏–µ 5 –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç"
        fi
        
        echo ""
        echo "‚ùå –í–°–ï –†–ï–®–ï–ù–ò–Ø –ù–ï –†–ê–ë–û–¢–ê–Æ–¢"
        echo "–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –ø—Ä–æ–µ–∫—Ç–∞"
        
        echo "‚úÖ –¢–µ—Å—Ç 10 –∑–∞–≤–µ—Ä—à–µ–Ω"
        
    - name: Upload Test 10 Results
      uses: actions/upload-artifact@v4
      if: always()
      with:
        name: ios-simple-test-10
        path: mobile_apps/ALADDIN_iOS/build/
        retention-days: 1
