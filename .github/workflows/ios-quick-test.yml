name: iOS Quick Test

on:
  workflow_dispatch:
  push:
    branches: [ main ]
    paths: [ 'mobile_apps/ALADDIN_iOS/quick_test.txt' ]

jobs:
  quick-test:
    runs-on: macos-latest
    timeout-minutes: 5
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v4
      
    - name: Setup Xcode
      uses: maxim-lobanov/setup-xcode@v1
      with:
        xcode-version: '16.0.0'
        
    - name: Quick iOS Test
      run: |
        echo "üöÄ –ë–´–°–¢–†–´–ô –¢–ï–°–¢ iOS –ö–û–ú–ü–ò–õ–Ø–¶–ò–ò"
        echo "================================"
        
        echo ""
        echo "üì± 1. –í–µ—Ä—Å–∏—è Xcode:"
        xcodebuild -version
        
        echo ""
        echo "üì± 2. –î–æ—Å—Ç—É–ø–Ω—ã–µ —Å–∏–º—É–ª—è—Ç–æ—Ä—ã:"
        xcrun simctl list devices available | grep iPhone | head -3
        
        echo ""
        echo "üì± 3. –ü–µ—Ä–µ—Ö–æ–¥–∏–º –≤ –ø–∞–ø–∫—É –ø—Ä–æ–µ–∫—Ç–∞:"
        cd mobile_apps/ALADDIN_iOS
        pwd
        ls -la
        
        echo ""
        echo "üì± 4. –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ö–µ–º—É:"
        xcodebuild -project ALADDIN.xcodeproj -list | head -10
        
        echo ""
        echo "üì± 5. –¢–ï–°–¢ 1: –ë–µ–∑ destination"
        if timeout 60 xcodebuild -project ALADDIN.xcodeproj -scheme ALADDIN build; then
          echo "‚úÖ –¢–ï–°–¢ 1 –£–°–ü–ï–•: –ë–µ–∑ destination —Ä–∞–±–æ—Ç–∞–µ—Ç!"
        else
          echo "‚ùå –¢–ï–°–¢ 1 –ü–†–û–í–ê–õ: –ë–µ–∑ destination –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç"
        fi
        
        echo ""
        echo "üì± 6. –¢–ï–°–¢ 2: –° generic destination"
        if timeout 60 xcodebuild -project ALADDIN.xcodeproj -scheme ALADDIN -destination "generic/platform=iOS Simulator" build; then
          echo "‚úÖ –¢–ï–°–¢ 2 –£–°–ü–ï–•: generic/platform=iOS Simulator —Ä–∞–±–æ—Ç–∞–µ—Ç!"
        else
          echo "‚ùå –¢–ï–°–¢ 2 –ü–†–û–í–ê–õ: generic/platform=iOS Simulator –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç"
        fi
        
        echo ""
        echo "üì± 7. –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç:"
        ls -la build/ || echo "build –ø–∞–ø–∫–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞"
        find build/ -name "*.app" -type d || echo ".app —Ñ–∞–π–ª—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã"
