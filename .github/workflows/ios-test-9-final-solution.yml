name: iOS Test 9 - Final Solution

on:
  push:
    branches: [ main ]
    paths: [ 'mobile_apps/ALADDIN_iOS/trigger_test9.txt' ]

jobs:
  test-9-final-solution:
    runs-on: macos-latest
    timeout-minutes: 15
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v4
      
    - name: Setup Xcode
      uses: maxim-lobanov/setup-xcode@v1
      with:
        xcode-version: '16.0.0'
        
    - name: Test 9 - Final Solution
      run: |
        cd mobile_apps/ALADDIN_iOS
        echo "=== –¢–ï–°–¢ 9: –§–ò–ù–ê–õ–¨–ù–û–ï –†–ï–®–ï–ù–ò–ï ==="
        
        # –û—á–∏—â–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–µ —Å–±–æ—Ä–∫–∏
        rm -rf build/
        
        echo "–§–∏–Ω–∞–ª—å–Ω—ã–π —Ç–µ—Å—Ç —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏:"
        echo "- platform=iOS Simulator (—Å–∏–º—É–ª—è—Ç–æ—Ä, –Ω–µ —Ä–µ–∞–ª—å–Ω–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ)"
        echo "- name=iPhone 15 (—Ä–µ–∞–ª—å–Ω—ã–π —Å–∏–º—É–ª—è—Ç–æ—Ä)"
        echo "- configuration=Release (—Ä–µ–ª–∏–∑–Ω–∞—è –≤–µ—Ä—Å–∏—è)"
        
        # –§–∏–Ω–∞–ª—å–Ω–∞—è –∫–æ–º–ø–∏–ª—è—Ü–∏—è —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
        xcodebuild -project ALADDIN.xcodeproj -scheme ALADDIN -configuration Release -destination "platform=iOS Simulator,name=iPhone 15" build
        
        echo ""
        echo "=== –ü–†–û–í–ï–†–Ø–ï–ú –†–ï–ó–£–õ–¨–¢–ê–¢ ==="
        echo "Build –ø–∞–ø–∫–∞:"
        ls -la build/
        
        echo ""
        echo "–ò—â–µ–º .app —Ñ–∞–π–ª—ã:"
        find build/ -name "*.app" -type d || echo ".app —Ñ–∞–π–ª—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã"
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞–∑–º–µ—Ä .app —Ñ–∞–π–ª–∞
        APP_FILE=$(find build/ -name "*.app" -type d | head -1)
        if [ -n "$APP_FILE" ]; then
          echo ""
          echo "üì± –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ .app —Ñ–∞–π–ª–µ:"
          echo "–ü—É—Ç—å: $APP_FILE"
          echo "–†–∞–∑–º–µ—Ä: $(du -sh "$APP_FILE" | cut -f1)"
          echo ""
          echo "–°–æ–¥–µ—Ä–∂–∏–º–æ–µ .app —Ñ–∞–π–ª–∞:"
          ls -la "$APP_FILE"
        fi
        
    - name: Upload Test 9 Results
      uses: actions/upload-artifact@v4
      if: always()
      with:
        name: ios-test9-final-solution
        path: mobile_apps/ALADDIN_iOS/build/
        retention-days: 7
