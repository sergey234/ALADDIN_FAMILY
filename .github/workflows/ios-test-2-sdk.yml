name: iOS Test 2 - SDK Version Fix
on:
  push:
    branches: [ main ]
    paths: [ 'mobile_apps/ALADDIN_iOS/test2.txt' ]
  workflow_dispatch:

jobs:
  ios-test-2:
    runs-on: macos-latest
    timeout-minutes: 5
    steps:
    - name: Checkout code
      uses: actions/checkout@v4
    
    - name: Setup Xcode
      uses: maxim-lobanov/setup-xcode@v1
      with:
        xcode-version: '16.0.0'
    
    - name: iOS Test 2 - SDK Version Fix
      run: |
        cd mobile_apps/ALADDIN_iOS
        echo "üß™ –¢–ï–°–¢ 2: SDK –í–ï–†–°–ò–Ø - –ö–û–ù–ö–†–ï–¢–ù–ê–Ø SDK"
        echo "====================================="
        echo ""
        echo "üîç –ü–†–û–ë–õ–ï–ú–ê:"
        echo "‚ùå SDK 22A3362 –Ω–µ —Å–æ–≤–º–µ—Å—Ç–∏–º —Å runtime [22E238, 22F77, 22G86, 23A343]"
        echo ""
        echo "‚úÖ –†–ï–®–ï–ù–ò–ï:"
        echo "–ò—Å–ø–æ–ª—å–∑—É–µ–º –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é SDK –≤–µ—Ä—Å–∏—é –∏–∑ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö"
        echo ""
        echo "üîç –î–æ—Å—Ç—É–ø–Ω—ã–µ iOS SDK:"
        xcodebuild -showsdks | grep "iOS"
        echo ""
        echo "üß™ –¢–ï–°–¢: –° –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π SDK –≤–µ—Ä—Å–∏–µ–π"
        # –ü–æ–ø—Ä–æ–±—É–µ–º —Å iphonesimulator SDK
        if xcodebuild -project ALADDIN.xcodeproj -scheme ALADDIN -sdk iphonesimulator build; then
          echo "‚úÖ –£–°–ü–ï–•! SDK iphonesimulator —Ä–∞–±–æ—Ç–∞–µ—Ç!"
          
          echo ""
          echo "üì± –†–µ–∑—É–ª—å—Ç–∞—Ç —Å–±–æ—Ä–∫–∏:"
          ls -la build/ || echo "build –ø–∞–ø–∫–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞"
          echo ""
          echo "üì± –ò—â–µ–º .app —Ñ–∞–π–ª—ã:"
          find build/ -name "*.app" -type d || echo ".app —Ñ–∞–π–ª—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã"
          
          echo ""
          echo "üéâ –†–ï–®–ï–ù–ò–ï –ù–ê–ô–î–ï–ù–û!"
          echo "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ: -sdk iphonesimulator"
        else
          echo "‚ùå SDK iphonesimulator –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç"
          echo "–ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç—É–ø–Ω—ã–µ runtime:"
          xcrun simctl list runtimes | grep iOS | head -3
        fi
