name: iOS Minimal Test - Basic Check

on:
  push:
    branches: [ main ]
    paths: [ 'mobile_apps/ALADDIN_iOS/minimal_test.txt' ]

jobs:
  minimal-test:
    runs-on: macos-latest
    timeout-minutes: 5
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v4
      
    - name: Minimal Test - Basic Check
      run: |
        echo "üîç –ú–ò–ù–ò–ú–ê–õ–¨–ù–´–ô –¢–ï–°–¢ - –ë–ê–ó–û–í–ê–Ø –ü–†–û–í–ï–†–ö–ê"
        echo "====================================="
        
        echo "1Ô∏è‚É£ –ü–†–û–í–ï–†–Ø–ï–ú –ù–ê–õ–ò–ß–ò–ï XCODE:"
        which xcodebuild || echo "xcodebuild –Ω–µ –Ω–∞–π–¥–µ–Ω"
        xcodebuild -version || echo "xcodebuild –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç"
        
        echo ""
        echo "2Ô∏è‚É£ –ü–†–û–í–ï–†–Ø–ï–ú –ù–ê–õ–ò–ß–ò–ï –°–ò–ú–£–õ–Ø–¢–û–†–û–í:"
        which xcrun || echo "xcrun –Ω–µ –Ω–∞–π–¥–µ–Ω"
        xcrun simctl list devices | head -10 || echo "simctl –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç"
        
        echo ""
        echo "3Ô∏è‚É£ –ò–©–ï–ú –õ–Æ–ë–´–ï iOS –ü–†–û–ï–ö–¢–´:"
        find . -name "*.xcodeproj" -type d | head -5
        find . -name "*.xcworkspace" -type d | head -5
        
        echo ""
        echo "4Ô∏è‚É£ –ü–†–û–í–ï–†–Ø–ï–ú SDK:"
        xcodebuild -showsdks | grep -i ios | head -5 || echo "iOS SDK –Ω–µ –Ω–∞–π–¥–µ–Ω—ã"
        
        echo ""
        echo "5Ô∏è‚É£ –ü–†–û–°–¢–ê–Ø –ü–†–û–í–ï–†–ö–ê –ö–û–ú–ü–ò–õ–Ø–¶–ò–ò:"
        if find . -name "*.xcodeproj" -type d | head -1 | read project; then
          echo "–ù–∞–π–¥–µ–Ω –ø—Ä–æ–µ–∫—Ç: $project"
          cd "$(dirname "$project")"
          echo "–ü—Ä–æ–±—É–µ–º –∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞—Ç—å:"
          xcodebuild -project "$(basename "$project")" -list || echo "–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ —Å—Ö–µ–º"
        else
          echo "‚ùå –ù–ò –û–î–ù–û–ì–û .xcodeproj –§–ê–ô–õ–ê –ù–ï –ù–ê–ô–î–ï–ù–û!"
        fi
        
    - name: Upload Minimal Results
      uses: actions/upload-artifact@v4
      if: always()
      with:
        name: ios-minimal-test
        path: .
        retention-days: 1
